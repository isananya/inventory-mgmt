
1.0isananya_inventory-mgmtJavaFrontend"1767544936422*java2.B˝+
S
Nuser-service/src/test/java/com/chubb/inventoryapp/security/JwtServiceTest.java2
	
type3
	
TEST4


module-key5

user-service6

package8
1
,user-service:com.chubb.inventoryapp.security9
4
.com.chubb.inventoryapp.security.JwtServiceTest11

class12

access13

	protected14


full-range15

(24:1)-(151:2)16

simple-name17

JwtServiceTest18
0
*org.junit.jupiter.api.extension.ExtendWith20

unknown21

annotated by22


uses23
0
*org.mockito.junit.jupiter.MockitoExtension25
?
9com.chubb.inventoryapp.security.JwtServiceTest.jwtService27

field28

private29

(27:5)-(27:35)30


jwtService31
0
*com.chubb.inventoryapp.security.JwtService33

is type34
;
5com.chubb.inventoryapp.security.JwtServiceTest.secret36

(29:5)-(29:70)37

secret38
A
;com.chubb.inventoryapp.security.JwtServiceTest.expirationMs40

(30:5)-(30:54)41

expirationMs42
@
:com.chubb.inventoryapp.security.JwtServiceTest.userDetails44

(32:5)-(33:41)45

userDetails46
5
/com.chubb.inventoryapp.security.UserDetailsImpl48

org.mockito.Mock50
9
3com.chubb.inventoryapp.security.JwtServiceTest.user52

(35:5)-(36:23)53


user54
'
!com.chubb.inventoryapp.model.User56
=
7com.chubb.inventoryapp.security.JwtServiceTest#setUp()V58

method59

(38:5)-(41:6)60

setUp61
&
 org.junit.jupiter.api.BeforeEach63


references64

calls65
M
Gcom.chubb.inventoryapp.security.JwtServiceTest#generateToken_Success()V67

(43:5)-(55:6)68

generateToken_Success69
 
org.junit.jupiter.api.Test71
*
$org.mockito.stubbing.OngoingStubbing73

returns74
o
iorg.mockito.stubbing.OngoingStubbing#thenReturn(Ljava/lang/Object;)Lorg/mockito/stubbing/OngoingStubbing;76

org.mockito.Mockito78
X
Rorg.mockito.Mockito#when(Ljava/lang/Object;)Lorg/mockito/stubbing/OngoingStubbing;80
U
Ocom.chubb.inventoryapp.security.UserDetailsImpl#getUsername()Ljava/lang/String;82
b
\com.chubb.inventoryapp.security.UserDetailsImpl#getUser()Lcom/chubb/inventoryapp/model/User;84
'
!com.chubb.inventoryapp.model.Role86
T
Ncom.chubb.inventoryapp.model.User#getRole()Lcom/chubb/inventoryapp/model/Role;88
0
*com.chubb.inventoryapp.model.Role.CUSTOMER90
É
}com.chubb.inventoryapp.security.JwtService#generateToken(Lcom/chubb/inventoryapp/security/UserDetailsImpl;)Ljava/lang/String;92
&
 org.junit.jupiter.api.Assertions94
I
Corg.junit.jupiter.api.Assertions#assertNotNull(Ljava/lang/Object;)V96
6
0org.junit.jupiter.api.Assertions#assertFalse(Z)V98
9
2org.junit.jupiter.api.Assertions#assertEquals(II)V100
P
Icom.chubb.inventoryapp.security.JwtServiceTest#extractUsername_Success()V102

(57:5)-(67:6)103

extractUsername_Success104
.
'com.chubb.inventoryapp.model.Role.ADMIN106
g
`com.chubb.inventoryapp.security.JwtService#extractUsername(Ljava/lang/String;)Ljava/lang/String;108
[
Torg.junit.jupiter.api.Assertions#assertEquals(Ljava/lang/Object;Ljava/lang/Object;)V110
L
Ecom.chubb.inventoryapp.security.JwtServiceTest#extractRole_Success()V112

(69:5)-(79:6)113

extractRole_Success114
c
\com.chubb.inventoryapp.security.JwtService#extractRole(Ljava/lang/String;)Ljava/lang/String;116
M
Fcom.chubb.inventoryapp.security.JwtServiceTest#isTokenValid_Success()V118

(81:5)-(92:6)119

isTokenValid_Success120
è
ácom.chubb.inventoryapp.security.JwtService#isTokenValid(Ljava/lang/String;Lorg/springframework/security/core/userdetails/UserDetails;)Z122
6
/org.junit.jupiter.api.Assertions#assertTrue(Z)V124
c
\com.chubb.inventoryapp.security.JwtServiceTest#isTokenValid_UsernameMismatch_ReturnsFalse()V126

(94:5)-(108:6)127
1
*isTokenValid_UsernameMismatch_ReturnsFalse128
@
9org.springframework.security.core.userdetails.UserDetails130
D
=org.mockito.Mockito#mock(Ljava/lang/Class;)Ljava/lang/Object;132
`
Yorg.springframework.security.core.userdetails.UserDetails#getUsername()Ljava/lang/String;134
b
[com.chubb.inventoryapp.security.JwtServiceTest#isTokenValid_ExpiredToken_ThrowsException()V136

(110:5)-(122:6)137
0
)isTokenValid_ExpiredToken_ThrowsException138
$
io.jsonwebtoken.security.Keys140
N
Gio.jsonwebtoken.security.Keys#hmacShaKeyFor([B)Ljavax/crypto/SecretKey;142
!
io.jsonwebtoken.JwtBuilder144
=
6io.jsonwebtoken.JwtBuilder#compact()Ljava/lang/String;146
[
Tio.jsonwebtoken.JwtBuilder#signWith(Ljava/security/Key;)Lio/jsonwebtoken/JwtBuilder;148
Z
Sio.jsonwebtoken.JwtBuilder#expiration(Ljava/util/Date;)Lio/jsonwebtoken/JwtBuilder;150
X
Qio.jsonwebtoken.JwtBuilder#issuedAt(Ljava/util/Date;)Lio/jsonwebtoken/JwtBuilder;152
i
bio.jsonwebtoken.JwtBuilder#claim(Ljava/lang/String;Ljava/lang/Object;)Lio/jsonwebtoken/JwtBuilder;154
Y
Rio.jsonwebtoken.JwtBuilder#subject(Ljava/lang/String;)Lio/jsonwebtoken/JwtBuilder;156

io.jsonwebtoken.Jwts158
A
:io.jsonwebtoken.Jwts#builder()Lio/jsonwebtoken/JwtBuilder;160
*
#io.jsonwebtoken.ExpiredJwtException162
à
Äorg.junit.jupiter.api.Assertions#assertThrows(Ljava/lang/Class;Lorg/junit/jupiter/api/function/Executable;)Ljava/lang/Throwable;164
j
ccom.chubb.inventoryapp.security.JwtServiceTest#extractAllClaims_InvalidSignature_ThrowsException()V166

(124:5)-(136:6)167
8
1extractAllClaims_InvalidSignature_ThrowsException168
\
Ucom.chubb.inventoryapp.security.JwtServiceTest#extractClaim_ExpirationDate_Success()V170

(138:5)-(150:6)171
*
#extractClaim_ExpirationDate_Success172
Å
zcom.chubb.inventoryapp.security.JwtService#extractClaim(Ljava/lang/String;Ljava/util/function/Function;)Ljava/lang/Object;174

io.jsonwebtoken.Claims176J%
#
1
12

3
4

5
6 Z

7
7982


5
68j≤

89
899021

62
626321

115
11511621

95
959621

19
192021

107
10710821

99
9910021
S
101L
10110259 *
1:
 :(!210:7B&


13
14

15
103

17
104

143
14314421

155
15515621
S
111L
11111259 *
1F
 F(210:7B&


13
14

15
113

17
114

87
878821
S
165L
16516659 *
1}
 }(;210:7B&


13
14

15
167

17
168
S
135L
13513659 *
1o
 o(3210:7B&


13
14

15
137

17
138
N
35H
353628 *
1 ( 210:7B$


13
29


15
37


17
38

24
242521

105
10510621

85
858621

97
979821

147
14714821

83
838421

75
757621

55
555621
N
51H
515228 *
1$ $(210:7B$


13
29


15
53


17
54

70
707121

123
12312421
S
125L
12512659 *
1_
 _(4210:7B&


13
14

15
127

17
128

157
15715821

161
16116221

159
15916021

141
14114221

79
798021

145
14514621

81
818221
J
10D
101112 *
1 (:7B$


13
14


15
16


17
18

49
495021

151
15115221
S
117L
11711859 *
1R
 R(210:7B&


13
14

15
119

17
120

47
474821

131
13113221
N
57H
575859 *
1'
 '(210:7B$


13
14


15
60


17
61

175
17517621
U
169N
16917059 *
1ã
 ã(-210:7B&


13
14

15
171

17
172

32
323321
N
43H
434428 *
1! !((210:7B$


13
29


15
45


17
46

139
13914021

129
12913021

153
15315421

163
16316421

173
17317421

72
727321

121
12112221

133
13313421
N
39H
394028 *
1 ($210:7B$


13
29


15
41


17
42

77
777821

149
14915021
N
26H
262728 *
1 ("210:7B$


13
29


15
30


17
31

109
10911021
N
66H
666759 *
1,
 ,(210:7B$


13
14


15
68


17
69

93
939421

91
919221r≥h

101922*
1 ($

101923*
1 (

102423*
1 (

263234*
1 (

263223*
1 (

263223*
1 ("

434734*
1! !(

434922*
1   (


434923*
1   (


434723*
1! !(

434723*
1! !((

515534*
1$ $(

514922*
1# #(


514923*
1# #(


515523*
1$ $(

515523*
1$ $(

576222*
1& &(

576223*
1& &(

573223*
1(	 ((

572664*
1(	 ((

573265*
1( (($

573564*
1(% ((+

573964*
1(- ((9

667022*
1+ +(


667023*
1+ +(


667274*
1-	 -(3

667264*
1-	 -(3

667565*
1-) -(3

667274*
1-	 -(

667764*
1-	 -(

667965*
1-	 -(

664764*
1- -(%

668165*
1- -(%

664364*
1- -(

664723*
1- -(

664364*
1- -(

667274*
1.	 .(/

667264*
1.	 .(/

667565*
1.% .(/

667274*
1.	 .(

667764*
1.	 .(

667965*
1.	 .(

665574*
1. .(!

664764*
1. .(!

668365*
1. .(!

664364*
1. .(

664723*
1. .(

664364*
1. .(

665523*
1.0 .(4

665164*
1.0 .(4

667274*
1/	 /((

667264*
1/	 /((

667565*
1/ /((

667274*
1/	 /(

667764*
1/	 /(

667965*
1/	 /(

668574*
1/ /(

665564*
1/ /(

668765*
1/ /(

665164*
1/ /(

665523*
1/ /(

665164*
1/ /(

668523*
1/) /(-

668523*
1/. /(6

668964*
1/. /(6

663264*
11 1(0

669165*
11# 1(0

662664*
11 1("

663223*
11 1("

662664*
11 1("

664723*
111 1(<

664364*
111 1(<

669364*
13	 3(

669565*
13	 3(

669364*
14	 4(

669765*
14	 4(

669364*
16	 6(

669965*
16	 6(

1017022*
19 9(


1017023*
19 9(


1017274*
1;	 ;(3

1017264*
1;	 ;(3

1017565*
1;) ;(3

1017274*
1;	 ;(

1017764*
1;	 ;(

1017965*
1;	 ;(

1014764*
1; ;(%

1018165*
1; ;(%

1014364*
1; ;(

1014723*
1; ;(

1014364*
1; ;(

1017274*
1<	 <(/

1017264*
1<	 <(/

1017565*
1<% <(/

1017274*
1<	 <(

1017764*
1<	 <(

1017965*
1<	 <(

1015574*
1< <(!

1014764*
1< <(!

1018365*
1< <(!

1014364*
1< <(

1014723*
1< <(

1014364*
1< <(

1015523*
1<0 <(4

1015164*
1<0 <(4

1017274*
1=	 =((

1017264*
1=	 =((

1017565*
1= =((

1017274*
1=	 =(

1017764*
1=	 =(

1017965*
1=	 =(

1018574*
1= =(

1015564*
1= =(

1018765*
1= =(

1015164*
1= =(

1015523*
1= =(

1015164*
1= =(

1018523*
1=) =(-

1018523*
1=. =(3

10110564*
1=. =(3

1013264*
1? ?(0

1019165*
1?# ?(0

1012664*
1? ?("

1013223*
1? ?("

1012664*
1? ?("

1014723*
1?1 ?(<

1014364*
1?1 ?(<

1013264*
1@ @(5

10110765*
1@& @(5

1012664*
1@ @(%

1013223*
1@ @(%

1012664*
1@ @(%

1019364*
1B	 B(

10110965*
1B	 B(

1117022*
1E E(


1117023*
1E E(


1117274*
1G	 G(3

1117264*
1G	 G(3

1117565*
1G) G(3

1117274*
1G	 G(

1117764*
1G	 G(

1117965*
1G	 G(

1114764*
1G G(%

1118165*
1G G(%

1114364*
1G G(

1114723*
1G G(

1114364*
1G G(

1117274*
1H	 H(/

1117264*
1H	 H(/

1117565*
1H% H(/

1117274*
1H	 H(

1117764*
1H	 H(

1117965*
1H	 H(

1115574*
1H H(!

1114764*
1H H(!

1118365*
1H H(!

1114364*
1H H(

1114723*
1H H(

1114364*
1H H(

1115523*
1H0 H(4

1115164*
1H0 H(4

1117274*
1I	 I((

1117264*
1I	 I((

1117565*
1I I((

1117274*
1I	 I(

1117764*
1I	 I(

1117965*
1I	 I(

1118574*
1I I(

1115564*
1I I(

1118765*
1I I(

1115164*
1I I(

1115523*
1I I(

1115164*
1I I(

1118523*
1I) I(-

1118523*
1I. I(3

11110564*
1I. I(3

1113264*
1K K(0

1119165*
1K# K(0

1112664*
1K K("

1113223*
1K K("

1112664*
1K K("

1114723*
1K1 K(<

1114364*
1K1 K(<

1113264*
1L L(-

11111565*
1L" L(-

1112664*
1L L(!

1113223*
1L L(!

1112664*
1L L(!

1119364*
1N	 N(

11110965*
1N	 N(

1177022*
1Q Q(


1177023*
1Q Q(


1177274*
1S	 S(3

1177264*
1S	 S(3

1177565*
1S) S(3

1177274*
1S	 S(

1177764*
1S	 S(

1177965*
1S	 S(

1174764*
1S S(%

1178165*
1S S(%

1174364*
1S S(

1174723*
1S S(

1174364*
1S S(

1177274*
1T	 T(/

1177264*
1T	 T(/

1177565*
1T% T(/

1177274*
1T	 T(

1177764*
1T	 T(

1177965*
1T	 T(

1175574*
1T T(!

1174764*
1T T(!

1178365*
1T T(!

1174364*
1T T(

1174723*
1T T(

1174364*
1T T(

1175523*
1T0 T(4

1175164*
1T0 T(4

1177274*
1U	 U((

1177264*
1U	 U((

1177565*
1U U((

1177274*
1U	 U(

1177764*
1U	 U(

1177965*
1U	 U(

1178574*
1U U(

1175564*
1U U(

1178765*
1U U(

1175164*
1U U(

1175523*
1U U(

1175164*
1U U(

1178523*
1U) U(-

1178523*
1U. U(6

1178964*
1U. U(6

1173264*
1W W(0

1179165*
1W# W(0

1172664*
1W W("

1173223*
1W W("

1172664*
1W W("

1174723*
1W1 W(<

1174364*
1W1 W(<

1173264*
1Y Y(2

11712165*
1Y& Y(2

1172664*
1Y Y(%

1173223*
1Y Y(%

1172664*
1Y Y(%

1174723*
1Y: Y(E

1174364*
1Y: Y(E

1179364*
1[	 [(

11712365*
1[	 [(

1257022*
1^ ^(


1257023*
1^ ^(


1257274*
1`	 `(3

1257264*
1`	 `(3

1257565*
1`) `(3

1257274*
1`	 `(

1257764*
1`	 `(

1257965*
1`	 `(

1254764*
1` `(%

1258165*
1` `(%

1254364*
1` `(

1254723*
1` `(

1254364*
1` `(

1257274*
1a	 a(/

1257264*
1a	 a(/

1257565*
1a% a(/

1257274*
1a	 a(

1257764*
1a	 a(

1257965*
1a	 a(

1255574*
1a a(!

1254764*
1a a(!

1258365*
1a a(!

1254364*
1a a(

1254723*
1a a(

1254364*
1a a(

1255523*
1a0 a(4

1255164*
1a0 a(4

1257274*
1b	 b((

1257264*
1b	 b((

1257565*
1b b((

1257274*
1b	 b(

1257764*
1b	 b(

1257965*
1b	 b(

1258574*
1b b(

1255564*
1b b(

1258765*
1b b(

1255164*
1b b(

1255523*
1b b(

1255164*
1b b(

1258523*
1b) b(-

1258523*
1b. b(6

1258964*
1b. b(6

1253264*
1d d(0

1259165*
1d# d(0

1252664*
1d d("

1253223*
1d d("

1252664*
1d d("

1254723*
1d1 d(<

1254364*
1d1 d(<

12512934*
1f f(

12512923*
1f	 f(

12512974*
1f! f(%

1257764*
1f! f(%

12513165*
1f! f(%

12512923*
1f& f(1

1257274*
1g	 g(1

1257264*
1g	 g(1

1257565*
1g' g(1

1257274*
1g	 g(

1257764*
1g	 g(

1257965*
1g	 g(

12512964*
1g g(#

12513365*
1g g(#

1253264*
1i i(2

12512165*
1i& i(2

1252664*
1i i(%

1253223*
1i i(%

1252664*
1i i(%

1259364*
1k	 k(

1259765*
1k	 k(

1357022*
1n n(


1357023*
1n n(


13513964*
1p p(+

13514165*
1p p(+

13513923*
1p p(

1353564*
1p, p(2

1353564*
1p, p(2

13514364*
1q w(

13514565*
1w w(

13514374*
1q v(

13514364*
1q v(

13514765*
1v v(

13514374*
1q u(

13514364*
1q u(

13514965*
1u u(

13514374*
1q t(

13514364*
1q t(

13515165*
1t t(

13514374*
1q s(

13514364*
1q s(

13515365*
1s s(

13514374*
1q r(

13514364*
1q r(

13515565*
1r r(

13514374*
1q q(+

13515764*
1q q(+

13515965*
1q$ q(+

13515723*
1q q(#

13516174*
1y	 y(

1359364*
1y	 y(

13516365*
1y	 y(

13516123*
1y y()

1353264*
1y7 y(N

13512165*
1yB y(N

1352664*
1y7 y(A

1353223*
1y7 y(A

1352664*
1y7 y(A

1354723*
1y] y(h

1354364*
1y] y(h

1657022*
1| |(


1657023*
1| |(


1657274*
1~	 ~(3

1657264*
1~	 ~(3

1657565*
1~) ~(3

1657274*
1~	 ~(

1657764*
1~	 ~(

1657965*
1~	 ~(

1654764*
1~ ~(%

1658165*
1~ ~(%

1654364*
1~ ~(

1654723*
1~ ~(

1654364*
1~ ~(

1657274*
1	 (/

1657264*
1	 (/

1657565*
1% (/

1657274*
1	 (

1657764*
1	 (

1657965*
1	 (

1655574*
1 (!

1654764*
1 (!

1658365*
1 (!

1654364*
1 (

1654723*
1 (

1654364*
1 (

1655523*
10 (4

1655164*
10 (4

1657274*
1Ä	 Ä((

1657264*
1Ä	 Ä((

1657565*
1Ä Ä((

1657274*
1Ä	 Ä(

1657764*
1Ä	 Ä(

1657965*
1Ä	 Ä(

1658574*
1Ä Ä(

1655564*
1Ä Ä(

1658765*
1Ä Ä(

1655164*
1Ä Ä(

1655523*
1Ä Ä(

1655164*
1Ä Ä(

1658523*
1Ä) Ä(-

1658523*
1Ä. Ä(6

1658964*
1Ä. Ä(6

1653264*
1Ç Ç(0

1659165*
1Ç# Ç(0

1652664*
1Ç Ç("

1653223*
1Ç Ç("

1652664*
1Ç Ç("

1654723*
1Ç1 Ç(<

1654364*
1Ç1 Ç(<

1659364*
1á	 á(

16516365*
1á	 á(

1653264*
1á- á(G

16510765*
1á8 á(G

1652664*
1á- á(7

1653223*
1á- á(7

1652664*
1á- á(7

1697022*
1ä ä(


1697023*
1ä ä(


1697274*
1å	 å(3

1697264*
1å	 å(3

1697565*
1å) å(3

1697274*
1å	 å(

1697764*
1å	 å(

1697965*
1å	 å(

1694764*
1å å(%

1698165*
1å å(%

1694364*
1å å(

1694723*
1å å(

1694364*
1å å(

1697274*
1ç	 ç(/

1697264*
1ç	 ç(/

1697565*
1ç% ç(/

1697274*
1ç	 ç(

1697764*
1ç	 ç(

1697965*
1ç	 ç(

1695574*
1ç ç(!

1694764*
1ç ç(!

1698365*
1ç ç(!

1694364*
1ç ç(

1694723*
1ç ç(

1694364*
1ç ç(

1695523*
1ç0 ç(4

1695164*
1ç0 ç(4

1697274*
1é	 é((

1697264*
1é	 é((

1697565*
1é é((

1697274*
1é	 é(

1697764*
1é	 é(

1697965*
1é	 é(

1698574*
1é é(

1695564*
1é é(

1698765*
1é é(

1695164*
1é é(

1695523*
1é é(

1695164*
1é é(

1698523*
1é) é(-

1698523*
1é. é(6

1698964*
1é. é(6

1693264*
1ê ê(0

1699165*
1ê# ê(0

1692664*
1ê ê("

1693223*
1ê ê("

1692664*
1ê ê("

1694723*
1ê1 ê(<

1694364*
1ê1 ê(<

1693264*
1í í(2

16917365*
1í& í(2

1692664*
1í í(%

1693223*
1í í(%

1692664*
1í í(%

16917523*
1í: í(@

1699364*
1î	 î(

1699565*
1î	 î(

1699364*
1ï	 ï(

16912365*
1ï	 ï(