<div class="orders-container">
  <h2>My Orders</h2>

  <div *ngIf="isLoading" class="loading">Loading your orders...</div>

  <div *ngIf="!isLoading && orders.length === 0" class="empty-state">
    <p>You haven't placed any orders yet.</p>
    <a routerLink="/shop" class="btn-link">Start Shopping</a>
  </div>

  <div class="orders-list" *ngIf="!isLoading && orders.length > 0">
    <div class="order-card" *ngFor="let order of orders">
      
      <div class="card-header">
        <div class="header-left">
          <span class="order-id">Order #{{ order.orderId }}</span>
          <span class="order-date">{{ order.createdAt | date:'mediumDate' }}</span>
        </div>
        <div class="header-right">
          <span class="status-badge" [style.background-color]="getStatusColor(order.status)">
            {{ order.status }}
          </span>
        </div>
      </div>

      <div class="card-body">
        <div class="order-details">
          <div class="detail-row">
            <span class="label">Shipped To:</span>
            <span class="value">{{ order.address.line1 }},{{ order.address.city }}, {{ order.address.state }}</span>
          </div>
          <div class="detail-row total">
            <span class="label">Total Amount:</span>
            <span class="value amount">Rs {{ order.totalAmount | number:'1.2-2' }}</span>
          </div>
        </div>
      </div>

      <div class="card-footer">
        <button 
          class="cancel-btn"
          [disabled]="order.status === 'CANCELLED' || order.status === 'DELIVERED'"
          (click)="initiateCancel(order.orderId)">
          {{ order.status === 'CANCELLED' ? 'Cancelled' : 'Cancel Order' }}
        </button>
      </div>

    </div>
  </div>

  <div class="pagination" *ngIf="totalPages > 1">
    <button (click)="changePage(-1)" [disabled]="currentPage === 0">Previous</button>
    <span>Page {{ currentPage + 1 }} of {{ totalPages }}</span>
    <button (click)="changePage(1)" [disabled]="currentPage >= totalPages - 1">Next</button>
  </div>
</div>

<div class="modal-overlay" *ngIf="showConfirmModal">
  <div class="modal-box">
    <h3>Cancel Order?</h3>
    <p>Are you sure you want to cancel Order #{{ selectedOrderId }}?</p>
    <p class="warning-text">This action cannot be undone.</p>
    
    <div class="modal-actions">
      <button class="btn-secondary" (click)="closeModals()">No, Keep Order</button>
      <button class="btn-danger" (click)="proceedCancel()">Yes, Cancel It</button>
    </div>
  </div>
</div>

<div class="modal-overlay" *ngIf="showSuccessModal">
  <div class="modal-box success-box">
    <div class="success-icon">âœ“</div>
    <h3>Order Cancelled</h3>
    <p>Your order has been successfully cancelled.</p>
    <button class="btn-primary" (click)="closeModals()">OK</button>
  </div>
</div>